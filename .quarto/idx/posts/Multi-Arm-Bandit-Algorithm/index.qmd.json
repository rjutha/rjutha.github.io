{"title":"How to enhance A/B testing with the Multi-arm Bandit","markdown":{"yaml":{"title":"How to enhance A/B testing with the Multi-arm Bandit","description":"An alternative algorithm for testing that leverages updating sampling frequencies for a more rapid decision than traditional apporaches.","bibliography":"resource.bib","twitter-card":{"image":"featured.png"},"author":[{"name":"Rahim Jutha","url":"https://rjutha.github.io/"}],"date":"10-04-2023","categories":["Data-Viz","R","TidyTuesday","Shiny","Bayesian"],"citation":{"url":"https://rjutha.github.io/posts/posts/Multi-Arm-Bandit-Algorithm/"},"image":"featured.png","draft":false},"headingText":"Set-up for examples","containsRefs":false,"markdown":"\n\nHello There!\n\nToday I'm going to be discussing an algorithm called the **Multi-Arm Bandit**, which is used in the realm of statistical testing. I came across the algorithm when reading the book *\"Practical Statistics for Data Scientists\"*. The book introduced the algorithm as \"an approach to testing ... that allows explicit optimization and more rapid decision making than the traditional statistical approach to designing experiments\" [@psfds]. Not only does the algorithm have a fun name, it also has a clear advantage when trying to optimize for the business rather than statistical significance.\n\nWhen compared to a traditional A/B test, the multi-arm bandit leverages taking advantage of results prior to the completion of an experiment. By utilizing the computing power of modern day tools, sampling can be updated efficiently during the sampling process to reach conclusions faster than traditional methods. An easy comparison to make is how in *Bayesian Statistics*, updating a prior distribution using evidence to obtain a new posterior distribution is a common idea and is essentially what this algorithm does.\n\nThe Multi-Arm Bandit algorithm is widely used web design and marketing. This is because the results in these fields are easily measured. Since the core advantage of this algorithm involves being able to alter the sampling process during the experiment, these fields work together nicely with the algorithm.\n\nFor the remainder of this blog post, I'm going to compare the methods and provide examples to see how they work.\n\n\nIn order to showcase the different methods I'm going to simulate an example business problem to show the differences between A/B testing and the Multi-Arm Bandit algorithm.\n\nLet's say we're a company wanting to run an experiment to find out which of their 2 advertisements performs best. We decide to run the experiment on the next 3000 customers by showing them a different advertisement and using the results to decide which one to deploy.\n\nUnbeknownst to us, Advertisement A has a 10% conversion rate and Advertisement B has a 15% conversion rate. These values will allow us to generate a sample for us to make inference on.\n\n### Load Libraries\n```{r}\n#| warning: FALSE\n#| output: FALSE\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggtext)\nlibrary(glue)\nlibrary(scales)\n```\n\n## A/B testing\n\nSample our data choose to split evenly ...\n\n```{r}\nset.seed(423)\n\nA_sample <- sample(0:1, 1500, replace = TRUE , prob = c(0.9,0.1))\nB_sample <- sample(0:1, 1500, replace = TRUE , prob = c(0.85,0.15))\n\ncontingency_table <-\n  tibble(\n    Outcome = c('Conversion', 'No Conversion'),\n    `Advertisement A` = c(sum(A_sample), 1500 - sum(A_sample)),\n    `Advertisement B` = c(sum(B_sample), 1500 - sum(B_sample))\n  ) %>%\n  column_to_rownames(\"Outcome\") %>%\n  as.matrix()\n\nA_conversion_rate <- contingency_table[1,1] / sum(contingency_table[,1])\nA_conversion_rate_95_moe <- 1.96 * sd(A_sample) / sqrt(1500)\n\nB_conversion_rate <- contingency_table[1,2] / sum(contingency_table[,2])\nB_conversion_rate_95_moe <- 1.96 * sd(B_sample) / sqrt(1500)\n\nkable(contingency_table) %>%\n  kable_styling('basic')\n```\n\nDecide which test to do gonna do chi squared\n\n```{r}\nresult <- chisq.test(contingency_table)\nresult\n```\n\nplot of results i guess\n\n```{r, fig.width= 6, fig.height=4}\n#| code-fold: TRUE\ncolors = c('grey92', '#0ca823')\n  \ntitle = glue('A/B Test show Advertisement B <span style = \"color:{colors[2]}\">**Performs Better**</span>.')\n\nsubtitle = glue('Chi-squared test with a p-value of {format.pval(result$p.value, digits = 2)} shows their <span style = \"color:{colors[2]}\">**Converstion Rates**</span> are<br>significantly different. A sample size of 1500 customers were used for each ad.')\n\n\ncontingency_table %>%\n  as_tibble(rownames = 'Outcome') %>%\n  pivot_longer(cols = 2:3, names_to = \"product\") %>%\n  mutate(\n    Outcome = factor(Outcome, levels = c('No Conversion', 'Conversion')),\n  )  %>%\n  ggplot() +\n  geom_col(aes(x = value, y = product, fill = Outcome),\n           show.legend = FALSE) +\n  theme_minimal() +\n  coord_flip(clip = \"off\") +\n  scale_fill_manual(\n    values = colors\n  ) +\n  labs(\n    title = title,\n    subtitle = subtitle,\n    x = NULL,\n    y = NULL\n    ) +\n  theme(\n    plot.title.position = 'plot',\n    plot.title = element_markdown(size = 18),\n    plot.subtitle = element_markdown(size = 12, lineheight = 1.2, margin = margin(0,0,0.5,0, unit = 'cm')),\n    axis.text.x  = element_blank(),\n    axis.line.x  = element_blank(),\n    axis.text.y  = element_blank(),\n    axis.line.y  = element_blank(),\n    panel.grid = element_blank()\n  ) +\n  annotate(\n    'text',\n    x = 1700,\n    y = 1,\n    size = 5,\n    label = 'Advertisement A'\n  ) +\n    annotate(\n    'text',\n    x = 1700,\n    y = 2,\n    size = 5,\n    label = 'Advertisement B'\n    ) +\n  annotate(\n    'text',\n    x = 750,\n    y = 1,\n    size = 6,\n    label = glue('{percent(A_conversion_rate, accuracy = 0.01)} +/- {percent(A_conversion_rate_95_moe, scale = 100, accuracy = 0.01)}'),\n    color = colors[2],\n    fontface = 'bold'\n  ) +\n  annotate(\n    'text',\n    x = 750,\n    y = 2,\n    size = 6,\n    label = glue('{percent(B_conversion_rate, accuracy = 0.01)} +/- {percent(B_conversion_rate_95_moe, scale = 100, accuracy = 0.01)}'),\n    color = colors[2],\n    fontface = 'bold'\n  )\n```\n\n## Multi-Arm-Bandito\n\nintroduce algorithm formally why its better in web testing context simple example (using the psilon-greedy algorithm for an A/B test described in teh text)\n\nhttps://www.rdocumentation.org/packages/contextual/versions/0.9.8.4\n\n## Thompson's sampling uses a Bayesian approach:\n\nsame concept using a beta prior instead seems better will read about it and provide a breif example\n\nhttps://www.r-bloggers.com/2019/09/multi-armed-bandits-as-an-a-b-testing-solution/\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"toc-depth":3,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.475","editor":"visual","theme":"cosmo","title-block-banner":true,"page-layout":"article","title":"How to enhance A/B testing with the Multi-arm Bandit","description":"An alternative algorithm for testing that leverages updating sampling frequencies for a more rapid decision than traditional apporaches.","bibliography":["resource.bib"],"twitter-card":{"image":"featured.png"},"author":[{"name":"Rahim Jutha","url":"https://rjutha.github.io/"}],"date":"10-04-2023","categories":["Data-Viz","R","TidyTuesday","Shiny","Bayesian"],"citation":{"url":"https://rjutha.github.io/posts/posts/Multi-Arm-Bandit-Algorithm/"},"image":"featured.png","draft":false},"extensions":{"book":{"multiFile":true}}}}}