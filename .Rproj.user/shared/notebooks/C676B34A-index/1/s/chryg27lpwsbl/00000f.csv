"0","#| code-fold: TRUE"
"0","colors = c('grey92', '#0ca823')"
"0","  "
"0","title = glue('A/B Test show Advertisement B <span style = ""color:{colors[2]}"">**Performs Better**</span>.')"
"0",""
"0","subtitle = glue('Chi-squared test with a p-value of {format.pval(result$p.value, digits = 2)} shows their <span style = ""color:{colors[2]}"">**Converstion Rates**</span> are<br>significantly different. A sample size of 1500 customers were used for each ad.')"
"0",""
"0",""
"0","contingency_table %>%"
"0","  as_tibble(rownames = 'Outcome') %>%"
"0","  pivot_longer(cols = 2:3, names_to = ""product"") %>%"
"0","  mutate("
"0","    Outcome = factor(Outcome, levels = c('No Conversion', 'Conversion')),"
"0","  )  %>%"
"0","  ggplot() +"
"0","  geom_col(aes(x = value, y = product, fill = Outcome),"
"0","           show.legend = FALSE) +"
"0","  theme_minimal() +"
"0","  coord_flip(clip = ""off"") +"
"0","  scale_fill_manual("
"0","    values = colors"
"0","  ) +"
"0","  labs("
"0","    title = title,"
"0","    subtitle = subtitle,"
"0","    x = NULL,"
"0","    y = NULL"
"0","    ) +"
"0","  theme("
"0","    plot.title.position = 'plot',"
"0","    plot.title = element_markdown(size = 18),"
"0","    plot.subtitle = element_markdown(size = 12, lineheight = 1.2, margin = margin(0,0,0.5,0, unit = 'cm')),"
"0","    axis.text.x  = element_blank(),"
"0","    axis.line.x  = element_blank(),"
"0","    axis.text.y  = element_blank(),"
"0","    axis.line.y  = element_blank(),"
"0","    panel.grid = element_blank()"
"0","  ) +"
"0","  annotate("
"0","    'text',"
"0","    x = 1700,"
"0","    y = 1,"
"0","    size = 5,"
"0","    label = 'Advertisement A'"
"0","  ) +"
"0","    annotate("
"0","    'text',"
"0","    x = 1700,"
"0","    y = 2,"
"0","    size = 5,"
"0","    label = 'Advertisement B'"
"0","    ) +"
"0","  annotate("
"0","    'text',"
"0","    x = 750,"
"0","    y = 1,"
"0","    size = 6,"
"0","    label = glue('{percent(A_conversion_rate, accuracy = 0.01)} +/- {percent(A_conversion_rate_95_moe, scale = 100, accuracy = 0.01)}'),"
"0","    color = colors[2],"
"0","    fontface = 'bold'"
"0","  ) +"
"0","  annotate("
"0","    'text',"
"0","    x = 750,"
"0","    y = 2,"
"0","    size = 6,"
"0","    label = glue('{percent(B_conversion_rate, accuracy = 0.01)} +/- {percent(B_conversion_rate_95_moe, scale = 100, accuracy = 0.01)}'),"
"0","    color = colors[2],"
"0","    fontface = 'bold'"
"0","  )"
